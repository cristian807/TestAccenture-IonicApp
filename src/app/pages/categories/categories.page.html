<!-- 
  Página de Categorías
  
  Aquí se pueden crear, editar y eliminar categorías
  para organizar las tareas.
-->

<!-- Header -->
<ion-header>
  <ion-toolbar color="primary">
    <!-- Botón del menú lateral -->
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    
    <ion-title>Categorías</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  
  <div class="add-category-section">
    <h3>Nueva Categoría</h3>
    
    <ion-item class="category-input">
      <ion-icon name="folder-outline" slot="start"></ion-icon>
      <ion-input 
        [(ngModel)]="newCategoryName" 
        placeholder="Nombre de la categoría"
        (keyup.enter)="addCategory()">
      </ion-input>
    </ion-item>
    
    <div class="color-selector">
      <ion-icon name="color-palette-outline"></ion-icon>
      <span>Color:</span>
      <div class="color-options">
        <div 
          *ngFor="let color of availableColors"
          class="color-option"
          [style.background-color]="color"
          [class.selected]="selectedColor === color"
          (click)="selectColor(color)">
        </div>
      </div>
    </div>
    
    <ion-button expand="block" (click)="addCategory()">
      <ion-icon name="add-outline" slot="start"></ion-icon>
      Crear Categoría
    </ion-button>
  </div>
  
  <div class="divider"></div>
  
  <h3>Mis Categorías</h3>
  
  <ion-list *ngIf="categories.length > 0">
    <ion-item-sliding *ngFor="let category of categories; trackBy: trackByCategoryId">
      
      <ion-item>
        <div 
          class="color-indicator" 
          [style.background-color]="category.color"
          slot="start">
        </div>
        
        <ion-label>
          <h2>{{ category.name }}</h2>
          <ion-note>{{ getTaskCount(category.id) }} tarea(s)</ion-note>
        </ion-label>
        
        <ion-button fill="clear" slot="end" (click)="editCategory(category)">
          <ion-icon name="create-outline" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-item>
      
      <ion-item-options side="end">
        <ion-item-option color="danger" (click)="deleteCategory(category)">
          <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
        </ion-item-option>
      </ion-item-options>
      
    </ion-item-sliding>
  </ion-list>
  
  <div class="empty-state" *ngIf="categories.length === 0">
    <ion-icon name="folder-outline"></ion-icon>
    <h2>Sin categorías</h2>
    <p>Crea tu primera categoría arriba</p>
  </div>

</ion-content>
